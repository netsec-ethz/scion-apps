{{define "trc"}} {{template "header" .}}

<script type="text/javascript" src="static/js/asviz.js"></script>

<div class="content">

 <div id='as-error'></div>

 <h2>SCIONLab Trust Roots</h2>
 <div id="as-tab-trc">
  <div id="as-trc">
   <div id="as-trclist">
    <i>.trc = Trust Root Configuration, .crt = AS Certificate</i>
    <div id="json-trc"></div>
   </div>
  </div>
 </div>

 <script type="text/javascript">
        $.when($.ajax({
            url : 'gettrc',
            type : 'post',
            dataType : "json",
            data : {
                "src" : "{{.MyIA}}"
            },
            timeout : 10000,
            success : function(data, textStatus, jqXHR) {
                console.info(JSON.stringify(data));
                if (data.err) {
                    showError(data.err);
                }
                $('#json-trc').html(json2html(data, true));
            },
            error : function(jqXHR, textStatus, errorThrown) {
                showError(this.url + ' ' + textStatus + ': ' + errorThrown);
            },
        }), $.ajax({
            url : 'getcrt',
            type : 'post',
            dataType : "json",
            data : {
                "src" : "{{.MyIA}}"
            },
            timeout : 10000,
            success : function(data, textStatus, jqXHR) {
                console.info(JSON.stringify(data));
                if (data.err) {
                    showError(data.err);
                }
                var items = $(json2html(data, true)).contents().unwrap();
                $('#json-trc ul.tree').append(items);
            },
            error : function(jqXHR, textStatus, errorThrown) {
                showError(this.url + ' ' + textStatus + ': ' + errorThrown);
            },
        })).then(function() {
            setupListTree();
        });
    </script>

</div>

{{template "footer" .}} {{end}}
